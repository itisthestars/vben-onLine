var k=(c,m,n)=>new Promise((s,u)=>{var p=r=>{try{l(n.next(r))}catch(i){u(i)}},d=r=>{try{l(n.throw(r))}catch(i){u(i)}},l=r=>r.done?s(r.value):Promise.resolve(r.value).then(p,d);l((n=n.apply(c,m)).next())});import{P as v}from"./index-DU2sVE1R.js";import{aM as V}from"./entry/index-BUx0ZtK4.js";import{u as b}from"./index-DZkByMAu.js";import{W as R,X as y,V as w,$ as T,l as C}from"./antd-BA4tRdrP.js";import{d as $,ai as g,a3 as B,V as E,a6 as e,k as o,u as a,X as x,G as _}from"./vue-CZYcLuVH.js";import"./useContentViewHeight-BzqGlWnE.js";import"./useWindowSizeFn-D9WlziNN.js";import"./onMountedOrActivated-DahpobXO.js";const M=$({__name:"index",setup(c){const m=()=>k(this,null,function*(){yield V()});function n(){return new Promise((i,t)=>{setTimeout(()=>{t(`TimeError: ${Date.now()}`)},1300)})}let s=0;const{loading:u,run:p,cancel:d}=b(n,{manual:!0,retryCount:5,onError(i){s===0&&(C.error("发现错误"),s++);const t=Date.now();C.error(`第 ${s++} 次重试, Time:${t}`)}}),l=()=>{s=0,p()},r=()=>{s=0,d(),C.info("已取消")};return(i,t)=>{const f=g("a-button");return E(),B(a(v),{title:"错误重试"},{default:e(()=>[o(a(R),{gutter:16},{default:e(()=>[o(a(y),{span:8},{default:e(()=>[o(a(w),{title:"Axios 错误重试"},{default:e(()=>[o(f,{onClick:m,type:"primary"},{default:e(()=>[...t[0]||(t[0]=[_(" 点击会重新发起请求5次 ",-1)])]),_:1}),t[1]||(t[1]=x("div",{class:"mt-4"},"打开浏览器的 network 面板，可以看到发出了六次请求",-1))]),_:1})]),_:1}),o(a(y),{span:8},{default:e(()=>[o(a(w),{title:"hooks 错误重试"},{default:e(()=>[o(a(T),null,{default:e(()=>[o(f,{onClick:l,type:"primary",disabled:a(u)},{default:e(()=>[...t[2]||(t[2]=[_(" 使用 hooks 发起重试 ",-1)])]),_:1},8,["disabled"]),o(f,{onClick:r},{default:e(()=>[...t[3]||(t[3]=[_("取消",-1)])]),_:1})]),_:1}),t[4]||(t[4]=x("div",{class:"mt-4"},"错误重试，retryInterval 如果不设置，默认采用简易的指数退避算法，取 1000 * 2 ** retryCount，也就是第一次重试等待 2s，第二次重试等待 4s，以此类推，如果大于 30s，则取 30s ",-1))]),_:1})]),_:1})]),_:1})]),_:1})}}});export{M as default};
