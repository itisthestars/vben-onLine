var ee=Object.defineProperty,te=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var $=(e,m,b)=>m in e?ee(e,m,{enumerable:!0,configurable:!0,writable:!0,value:b}):e[m]=b,f=(e,m)=>{for(var b in m||(m={}))oe.call(m,b)&&$(e,b,m[b]);if(J)for(var b of J(m))ne.call(m,b)&&$(e,b,m[b]);return e},H=(e,m)=>te(e,se(m));import{c as N,u as s,d as le,I as ae,n as re,A as ce,k as p,a8 as E,i as ie,G as de}from"./vue-DdhQyU-d.js";import{c as K}from"./componentMap-BfomYzjV.js";import{Q as fe,h as ue,s as G,R as me,O as he}from"./entry/index-DAHXR0BT.js";import{i as pe,N as Q,c as U,s as be}from"./helper-dtqtwqJr.js";import{ac as ge,h as y,aj as q,X,a4 as Y,j as ye,v as Ce,a6 as Pe,y as xe}from"./antd-Bp8JzQqk.js";function we(e){return"slot"in e}function Ae(e){return!we(e)}function Ie(e,m){return N(()=>{const b=s(e),{labelCol:L={},wrapperCol:M={}}=b.itemProps||{},{labelWidth:D,disabledLabelWidth:u}=b,{labelWidth:C,labelCol:v,wrapperCol:F,layout:T}=s(m);if(!C&&!D&&!v||u)return L.style={textAlign:"left"},{labelCol:L,wrapperCol:M};let A=D!=null?D:C;const V=f(f({},v),L),O=f(f({},F),M);return fe(A)&&(A=ge(A)?`${A}px`:A),{labelCol:f({style:{width:A}},V),wrapperCol:f({style:{width:T==="vertical"?"100%":`calc(100% - ${A})`}},O)}})}function _(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!ie(e)}const De=le({name:"BasicFormItem",inheritAttrs:!1,props:{schema:{type:Object,default:()=>({})},formProps:{type:Object,default:()=>({})},allDefaultValues:{type:Object,default:()=>({})},formModel:{type:Object,default:()=>({})},setFormModel:{type:Function,default:null},tableAction:{type:Object},formActionType:{type:Object},isAdvanced:{type:Boolean}},setup(e,{slots:m}){const{t:b}=ue(),{schema:L,formProps:M}=ae(e);L.value.component==="CropperAvatar"&&typeof M.value.size=="string"&&(M.value.size=void 0);const D=Ie(L,M),u=N(()=>{const{allDefaultValues:o,formModel:t,schema:r}=e,{mergeDynamicData:a}=e.formProps;return{field:r.field,model:t,values:f(f(f({},a),o),t),schema:r}}),C=N(()=>{var c;const{schema:o,tableAction:t,formModel:r,formActionType:a}=e;let{componentProps:n={}}=o;return y(n)&&(n=(c=n({schema:o,tableAction:t,formModel:r,formActionType:a}))!=null?c:{}),pe(o.component)&&(n=Object.assign({type:"horizontal"},{orientation:"left",plain:!0},n)),n}),v=N(()=>{const{disabled:o}=e.formProps,{dynamicDisabled:t}=e.schema,{disabled:r=!1}=s(C);let a=!!o||r;return q(t)&&(a=t),y(t)&&(a=t(s(u))),a}),F=N(()=>{const{readonly:o}=e.formProps,{dynamicReadonly:t}=e.schema,{readonly:r=!1}=s(C);let a=o||r;return q(t)&&(a=t),y(t)&&(a=t(s(u))),a});function T(){const{show:o,ifShow:t}=e.schema,{showAdvancedButton:r}=e.formProps,a=r&&q(e.isAdvanced)?e.isAdvanced:!0;let n=!0,c=!0;return q(o)&&(n=o),q(t)&&(c=t),y(o)&&(n=o(s(u))),y(t)&&(c=t(s(u))),n=n&&a,{isShow:n,isIfShow:c}}function A(){var j;const{rules:o=[],component:t,rulesMessageJoinLabel:r,label:a,dynamicRules:n,required:c}=e.schema;if(y(n))return n(s(u));let l=ye(o);const{rulesMessageJoinLabel:P}=e.formProps,I=(Reflect.has(e.schema,"rulesMessageJoinLabel")?r:P)?y(a)?"":a:"",x=t?U(t)+I:I;function h(d,i){const S=d.message||x;return i===void 0||Ce(i)||Array.isArray(i)&&i.length===0||typeof i=="string"&&i.trim()===""||typeof i=="object"&&Reflect.has(i,"checked")&&Reflect.has(i,"halfChecked")&&Array.isArray(i.checked)&&Array.isArray(i.halfChecked)&&i.checked.length===0&&i.halfChecked.length===0?Promise.reject(S):Promise.resolve()}const g=y(c)?c(s(u)):c;if(g)if(!l||l.length===0){const d=Q.includes(t||"Input")?"blur":"change";l=[{required:g,validator:h,trigger:d}]}else l.findIndex(i=>Reflect.has(i,"required"))===-1&&l.push({required:g,validator:h});const k=l.findIndex(d=>Reflect.has(d,"required")&&!Reflect.has(d,"validator"));if(k!==-1){const d=l[k],{isShow:i}=T();if(i||(d.required=!1),t){d.message=d.message||x,(t.includes("Input")||t.includes("Textarea"))&&(d.whitespace=!0);const S=(j=s(C))==null?void 0:j.valueFormat;be(d,t,S)}}const w=l.findIndex(d=>d.max);return w!==-1&&!l[w].validator&&(l[w].message=l[w].message||b("component.form.maxTip",[l[w].max])),l}function V(){var i;if(!Ae(e.schema))return null;const{renderComponentContent:o,component:t,field:r,changeEvent:a="change",valueField:n,valueFormat:c}=e.schema,l=t&&["Switch","Checkbox"].includes(t),P=`on${xe(a)}`,R={[P]:(...S)=>{const[B]=S,W=B?B.target:null;let z=W?l?W.checked:W.value:B;y(c)&&(z=c(H(f({},s(u)),{value:z}))),e.setFormModel(r,z,e.schema),g[P]&&g[P](...S)}},I=K.get(t),{autoSetPlaceHolder:x,size:h}=e.formProps,g=H(f({allowClear:!0,size:h},s(C)),{disabled:s(v),readonly:s(F)});!g.disabled&&x&&t!=="RangePicker"&&t&&(g.placeholder=((i=s(C))==null?void 0:i.placeholder)||U(t)),g.codeField=r,g.formValues=s(u);const w={[n||(l?"checked":"value")]:e.formModel[r]},j=f(f(f({},g),R),w);if(!o)return p(I,j,null);const d=y(o)?f({},o(s(u),{disabled:s(v),readonly:s(F)})):{default:()=>o};return p(I,j,_(d)?d:{default:()=>[d]})}function O(){const{label:o,helpMessage:t,helpComponentProps:r,subLabel:a}=e.schema,n=y(o)?o(s(u)):o,c=a?p("span",null,[n,de(" "),p("span",{class:"text-secondary"},[a])]):n,l=y(t)?t(s(u)):t;return!l||Array.isArray(l)&&l.length===0?c:p("span",null,[c,p(me,E({placement:"top",class:"mx-1",text:l},r),null)])}function Z(){const{itemProps:o,slot:t,render:r,field:a,suffix:n,component:c,prefix:l}=e.schema,{labelCol:P,wrapperCol:R}=s(D),{colon:I}=e.formProps,x={disabled:s(v),readonly:s(F)};if(c==="Divider"){let h;return p(X,{span:24},{default:()=>[p(Pe,s(C),_(h=O())?h:{default:()=>[h]})]})}else if(c==="BasicTitle"){let h;return p(Y.Item,{labelCol:P,wrapperCol:R,name:a,class:{"suffix-item":!!n,"prefix-item":!!l}},{default:()=>[p(he,s(C),_(h=O())?h:{default:()=>[h]})]})}else{const h=()=>t?G(m,t,s(u),x):r?r(s(u),x):V(),g=!!n,k=y(n)?n(s(u)):n,w=!!l,j=y(l)?l(s(u)):l;return c&&Q.includes(c)&&e.schema&&(e.schema.itemProps=f({autoLink:!1},e.schema.itemProps)),p(Y.Item,E({name:a,colon:I,class:{"suffix-item":g,"prefix-item":w}},o,{label:O(),rules:A(),labelCol:P,wrapperCol:R}),{default:()=>[p("div",{style:"display:flex"},[w&&p("span",{class:"prefix"},[j]),p("div",{style:"flex:1;"},[h()]),g&&p("span",{class:"suffix"},[k])])]})}}return()=>{let o;const{colProps:t={},colSlot:r,renderColContent:a,component:n,slot:c}=e.schema;if(!(n&&K.has(n)||c))return null;const{baseColProps:l={}}=e.formProps,P=f(f({},l),t),{isIfShow:R,isShow:I}=T(),x=s(u),h={disabled:s(v),readonly:s(F)};return R&&re(p(X,P,_(o=r?G(m,r,x,h):a?a(x,h):Z())?o:{default:()=>[o]}),[[ce,I]])}}});export{De as _};
