import{P as h}from"./index-D4crmGeM.js";import{aL as N,az as S}from"./entry/index-Be056_tE.js";import{G as B,U}from"./antd-BA4tRdrP.js";import{d as D,r as E,h as I,c as m,ai as g,a3 as O,V as p,a6 as n,X as t,k as o,u as r,G as c,$ as i,U as x,F as P,a4 as W}from"./vue-CZYcLuVH.js";import"./useContentViewHeight-DT9lRWta.js";import"./useWindowSizeFn-DzNNC3Qx.js";import"./onMountedOrActivated-DahpobXO.js";const A={class:"flex"},F={class:"w-1/3 bg-white p-4"},G={class:"flex items-center"},M={class:"flex"},z={class:"w-2/3 bg-white ml-4 p-4"},J={class:"max-h-80 overflow-auto"},R={class:"flex items-center"},Z=D({__name:"index",setup(X){const b=B.TextArea,s=E({server:"ws://localhost:3300/test",sendValue:"",recordList:[]}),{status:v,data:u,send:y,close:_,open:k}=N(s.server,{autoReconnect:!1,heartbeat:!0});I(()=>{if(u.value)try{const d=JSON.parse(u.value);s.recordList.push(d)}catch(d){s.recordList.push({res:u.value,id:Math.ceil(Math.random()*1e3),time:new Date().getTime()})}});const l=m(()=>v.value==="OPEN"),w=m(()=>l.value?"success":"red"),V=m(()=>[...s.recordList].reverse());function T(){y(s.sendValue),s.sendValue=""}function C(){l.value?_():k()}return(d,e)=>{const L=g("a-input"),f=g("a-button");return p(),O(r(h),{title:"WebSocket 示例"},{default:n(()=>[t("div",A,[t("div",F,[t("div",G,[e[2]||(e[2]=t("span",{class:"text-lg font-medium mr-4"}," 连接状态: ",-1)),o(r(U),{color:w.value},{default:n(()=>[c(i(r(v)),1)]),_:1},8,["color"])]),e[4]||(e[4]=t("hr",{class:"my-4"},null,-1)),t("div",M,[o(L,{value:s.server,"onUpdate:value":e[0]||(e[0]=a=>s.server=a),"addon-before":"服务地址",disabled:""},null,8,["value"]),o(f,{type:l.value?"danger":"primary",onClick:C},{default:n(()=>[c(i(l.value?"关闭连接":"开启连接"),1)]),_:1},8,["type"])]),e[5]||(e[5]=t("p",{class:"text-lg font-medium mt-4"},"设置",-1)),e[6]||(e[6]=t("hr",{class:"my-4"},null,-1)),o(r(b),{placeholder:"需要发送到服务器的内容",disabled:!l.value,value:s.sendValue,"onUpdate:value":e[1]||(e[1]=a=>s.sendValue=a),allowClear:""},null,8,["disabled","value"]),o(f,{type:"primary",block:"",class:"mt-4",disabled:!l.value,onClick:T},{default:n(()=>[...e[3]||(e[3]=[c(" 发送 ",-1)])]),_:1},8,["disabled"])]),t("div",z,[e[8]||(e[8]=t("span",{class:"text-lg font-medium mr-4"}," 消息记录: ",-1)),e[9]||(e[9]=t("hr",{class:"my-4"},null,-1)),t("div",J,[t("ul",null,[(p(!0),x(P,null,W(V.value,a=>(p(),x("li",{class:"mt-2",key:a.time},[t("div",R,[e[7]||(e[7]=t("span",{class:"mr-2 text-primary font-medium"},"收到消息:",-1)),t("span",null,i(r(S)(a.time)),1)]),t("div",null,i(a.res),1)]))),128))])])])])]),_:1})}}});export{Z as default};
